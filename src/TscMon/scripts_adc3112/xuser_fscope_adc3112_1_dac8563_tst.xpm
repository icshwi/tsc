#*****************************************************************#
#                    XprsMon Script file                          #
#                XUSER FASTSCOPE (2x ADC_3112)                    #
#   Title        : xuser_fscope_adc3112_1_dac8563_tst.xpm         #
#   Description  : Basic verification 1x DAC8563                  #
#   Author       : J. Bovier  / J-L Bolli                         #
#*****************************************************************#
# Version 0.1 16-01-2015 : Initial version ifC_1410/1211          #
#*****************************************************************#
#
# Check if FMC1 ADC_3112 is present + Signature OK
cr.ws 1200 31120201 FFFFFFFF                 # Check ADC_3112 SIGN_CSR (Type, Version, Revision)
cr.ws 1204 20000000 FF000000                 # Check ADC_3112 MAIN_CSR (options instantiated)
#
pr.ws 1200 31120000                             # Enable FMC physical interface (out of tri-state)
#
@ xuser_fscope_adc3112_1_xra1404_init.xpm
#
# -- WARNING DAC8563 SPI Bus is Write only 
#
$echo *****************************************************************
$echo DAC8563 U745                                 
$echo *****************************************************************
adc3112.1 dac write 38 0001                   # Enable Internal Reference & reset DACs to gain = 2
adc3112.1 dac write 02 0003                   # Gain DAC-B = 1 and Gain DAC-A = 1
#
adc3112.1 dac write 18 0000                   # Write to DAC-A input register and update DAC-A; 0 x FS
$usleep 2000 
adc3112.1 dac write 18 3FFF                   # Write to DAC-A input register and update DAC-A; 1/4 x FS
$usleep 2000 
adc3112.1 dac write 18 7FFF                   # Write to DAC-A input register and update DAC-A; 1/2 x FS
$usleep 2000 
adc3112.1 dac write 18 BFDD                   # Write to DAC-A input register and update DAC-A; 3/4 x FS
$usleep 2000 
adc3112.1 dac write 18 FFFF                   # Write to DAC-A input register and update DAC-A; 1 x FS
$usleep 2000 
adc3112.1 dac write 18 7FFF                   # Write to DAC-A input register and update DAC-A; 1/2 x FS
$usleep 2000 
#
adc3112.1 dac write 19 0000                   # Write to DAC-B input register and update DAC-B; 0 x FS
$usleep 2000 
adc3112.1 dac write 19 3FFF                   # Write to DAC-B input register and update DAC-B; 1/4 x FS
$usleep 2000 
adc3112.1 dac write 19 7FFF                   # Write to DAC-B input register and update DAC-B; 1/2 x FS
$usleep 2000 
adc3112.1 dac write 19 BFDD                   # Write to DAC-B input register and update DAC-B; 3/4 x FS
$usleep 2000 
adc3112.1 dac write 19 FFFF                   # Write to DAC-B input register and update DAC-B; 1 x FS
$usleep 2000 
adc3112.1 dac write 19 7FFF                   # Write to DAC-B input register and update DAC-B; 1/2 x FS
$usleep 2000 
#                                             
$echo *****************************************************************
$echo End DAC8563 Basic verification     
$echo *****************************************************************
# <EOF>
